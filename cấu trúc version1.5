cofure_bot/
├── main.py                     🚀 Khởi động Flask, webhook Messenger, nhận tin từ người dùng
├── init_files.py               🔧 Tạo file JSON trạng thái cần thiết khi bot khởi chạy
├── requirements.txt            📦 Khai báo thư viện: Flask, requests, dotenv, gunicorn...
├── Procfile                    ⚙️ Cấu hình lệnh khởi động bot trên dịch vụ hosting
├── .env.example                🔐 Mẫu cấu hình môi trường: Messenger token, PORT...

├── messenger/                  💬 Xử lý gửi/nhận tin nhắn từ người dùng qua Messenger
│   ├── mess_handler.py         📥 Xử lý tin nhắn đầu vào: lần đầu chào hỏi, phản hồi câu hỏi
│   ├── message_sender.py       📤 Format & gửi bản tin tín hiệu đến người dùng
│   └── registry_manager.py     ✅ Quản lý danh sách user đã xác nhận tham gia bot

├── scheduler/                  ⏰ Gửi nội dung theo thời điểm trong ngày
│   ├── cron_daemon.py          🧭 Bộ kiểm tra giờ & gọi tác vụ đúng thời điểm
│   ├── macro_reporter.py       🌅 Gửi bản tin sáng lúc 06:00 (tỷ giá, lịch kinh tế, xu hướng BTC)
│   ├── macro_advisor.py        🔔 Cảnh báo tin vĩ mô khi có CPI, FOMC, NFP...
│   ├── signals.py              📡 Gửi batch tín hiệu mỗi 15–30 phút: 5 lệnh MUA/BÁN cho ONUS
│   ├── end_day_report.py       📊 Báo cáo tổng hợp lúc 22:00 (hiệu suất, R:R, lời chúc ngủ ngon)
│   └── reset_state.py          🔄 Reset volume/funding/status lúc 23:00 để chuẩn bị ngày mới

├── core/                       🔍 Xử lý tín hiệu giao dịch kỹ thuật từ dữ liệu ONUS
│   ├── signal_generator.py     🔁 Sinh lệnh Long/Short từ volume, funding, RSI, trend
│   ├── signal_analyzer.py      📊 Chấm điểm tín hiệu → tính xác suất MUA/BÁN
│   ├── coin_filter.py          🧹 Lọc coin đủ điều kiện giao dịch mỗi phiên
│   └── strategy_classifier.py  🧠 Phân loại Swing / Scalp + kiểu lệnh Market / Limit

├── macro/                      🌍 Phân tích tin vĩ mô ảnh hưởng đến crypto
│   ├── event_watcher.py        📅 Quét & lên lịch tin tức CPI, FOMC, GDP theo ngày
│   └── news_analyzer.py        📈 Format tin & đánh giá tác động lên thị trường ONUS

├── marketdata/                 📈 Dữ liệu giá & volume từ sàn ONUS
│   ├── price_fetcher.py        💰 Lấy giá theo VND từng đồng coin ONUS từ API
│   ├── volume_tracker.py       🔎 Theo dõi biến động volume từng cặp ONUS
│   └── market_snapshot.py      🖼 Lưu tổng quan dữ liệu giá, funding, spread từng phiên

├── messages/                   ✉️ Trình bày bản tin gửi đẹp & dễ hiểu cho người dùng
│   ├── templates.py            📋 Format mẫu Entry, SL, TP, R:R cho từng lệnh
│   └── emoji_map.py            😀 Gắn biểu tượng theo sức mạnh lệnh và chiến thuật

├── utils/                      🔧 Các hàm tiện ích hỗ trợ toàn hệ thống
│   ├── formatter.py            🔢 Làm tròn số, phần trăm, tiền VND/USDT
│   ├── mid_tracker.py          🔁 Tránh phản hồi spam khi user nhắn lặp
│   └── json_utils.py           📁 Đọc / ghi JSON an toàn để lưu trạng thái

├── data/                       🗂 Dữ liệu trạng thái tạm của bot trong ngày
│   ├── user_registry.json      ✅ Danh sách người dùng đã kích hoạt bot
│   ├── processed_mids.json     🔁 Tin nhắn đã phản hồi → tránh spam
│   ├── macro_schedule.json     📅 Tin vĩ mô đã lên lịch → không trùng
│   ├── volume_state.json       📊 Trạng thái volume từng coin → dùng cho phân tích
│   └── used_coins.json         🔐 Danh sách coin đã dùng hôm nay → tránh trùng tín hiệu


               
*****Công dụng bot*****
phần 1:🔔 Khi người dùng lần đầu nhắn tin Messenger:

1️⃣ Bot gửi lời chào:
“Chào bạn 👋 Mình là Cofure — trợ lý gửi tín hiệu giao dịch thị trường ONUS.  
Bạn có muốn nhận bản tin & tín hiệu mỗi ngày không ạ?”

2️⃣ Hiển thị lựa chọn:
✅ Đồng ý  
❌ Từ chối

→ Nếu chọn ✅:
• Bot phản hồi:
“Bạn đã đăng ký nhận tín hiệu rồi nha!  
Hiện tại bạn đang chờ xét duyệt từ [Trương Tấn Phương](https://fb.com/quangnamttp)”  
• Lưu trạng thái: `approved = false`

→ Nếu chọn ❌:
• Bot phản hồi lịch sự:
“Không sao đâu, bạn có thể bật lại bất kỳ lúc nào nha 😊”

3️⃣ Sau khi admin xét duyệt thủ công:
• Bot cập nhật trạng thái `approved = true`  
• Người dùng bắt đầu nhận bản tin & tín hiệu hằng ngày

🔒 Người chưa được duyệt:
→ Không nhận bất kỳ bản tin, tín hiệu hay cảnh báo nào  
→ Đảm bảo không spam, không gây khó chịu với user mới
👤 Nếu user không muốn nhận tín hiệu nữa:

1️⃣ Khi user nhắn:
→ “Tắt tín hiệu” / “Không nhận nữa” / “Stop” / “Tạm nghỉ”…

2️⃣ Bot xử lý:
• Gửi xác nhận:
“Đã ghi nhận yêu cầu. Tín hiệu sẽ tạm dừng gửi từ bây giờ nha!”

• Cập nhật trạng thái: `signal_active = false`  
• Dừng toàn bộ bản tin, lệnh, cảnh báo

3️⃣ Nếu user muốn bật lại:
→ Nhắn: “Bật tín hiệu lại” / “Muốn nhận lại”  
→ Bot khôi phục: `signal_active = true`  
→ Gửi tin xác nhận: “Bạn đã bật lại chế độ nhận tín hiệu rồi nha!”

Phần2: 🕒 Khung giờ hoạt động: 06:00 → 22:00 mỗi ngày

🌞 06:00 — Chào buổi sáng + bản tin đầu ngày
• Tin nhắn cá nhân hóa: “Chào buổi sáng nhé {Tên} ☀️…”  
• Nội dung:
   ▸ Giá VNĐ BTC / ETH / SOL  
   ▸ Funding, volume, xu hướng  
• Dùng emoji nhẹ → tạo thiện cảm

📅 07:00 — Lịch tin vĩ mô
• Nếu không có tin:
→ “📅 Hôm nay không có tin tức vĩ mô quan trọng.  
Chúc bạn một ngày trade thật thành công nha!”

• Nếu có tin mạnh (CPI, FOMC...):
→ Bot gửi:
   ▸ Giờ ra tin  
   ▸ Loại tin  
   ▸ Mức ảnh hưởng  
   ▸ Gợi ý chiến lược → đứng ngoài hoặc chờ thời điểm

⚡ Mỗi 15–30 phút từ 06h → 22h — bot gửi 5 lệnh:
• Gồm 3 Scalping + 2 Swing  
• Mỗi lệnh có:
   ✔️ Loại: Market / Limit  
   ✔️ Entry / TP / SL bằng VNĐ  
   ✔️ Lý do kỹ thuật: volume, funding, mô hình, RSI  
   ✔️ Độ mạnh:
      📊 Mạnh ≥70%  
      📊 Tiêu chuẩn 50–69%  
      📊 Tham khảo <50%

⏰ Tín hiệu khẩn — ngoài chu kỳ
• Nếu volume / funding tăng bất thường → bot kích hoạt  
• Quét tất cả coin trên ONUS Futures  
• Báo TRƯỚC khi giá chạy → giúp user vào sớm đón sóng  
• Tin nhắn ví dụ:
  “⏰ Funding CHI vừa nghiêng Long mạnh, volume tăng đều.  
  Có thể cân nhắc MUA quanh vùng 32.800 VNĐ trước khi breakout.”

🧠 Dự báo sóng sớm — không đợi giá chạy
• Bot phát hiện mô hình tích lũy  
• Spread co hẹp, funding lệch, RSI tích cực  
→ Nếu các yếu tố đồng thuận → bot sinh lệnh trước cây nến bật

🕯️ Xử lý khi tin vĩ mô ra
1️⃣ Bot gửi số liệu:  
→ CPI thực tế / Dự báo / Kỳ trước  
→ Lãi suất FED / Dự báo thị trường

2️⃣ Phân tích phản ứng:
→ Funding / volume / spread / RSI biến động thế nào?

3️⃣ Gửi lời khuyên:
→ Ví dụ:
  “🕯️ CPI thấp hơn dự báo → market tích cực.  
  Funding BTC đang tăng nhẹ → có thể Long sau 5 phút nếu ổn định.”

→ Nếu thị trường rõ xu hướng → bot sinh lệnh chiến lược

🌒 22:00 — Tổng kết phiên
• Báo hiệu suất TP / SL  
• Biểu đồ tỷ lệ MUA / BÁN  
• Dự báo ngày mai  
• Lời chúc ngủ ngon:
→ “🌙 Cảm ơn bạn đã đồng hành cùng Cofure hôm nay. 😴 Ngủ ngon nha!”
